<!doctype html>
<meta charset="utf-8">
<title>Flow JSON Check</title>
<h1>Flow JSON Check</h1>
<p>Prüfe <code>/flows/flow.de.json</code> …</p>
<pre id="out" style="white-space:pre-wrap;border:1px solid #ccc;padding:8px"></pre>
<script>
(async () => {
  const out = document.getElementById('out');
  try {
    const url = "/flows/flow.de.json?_=" + Date.now();
    const res = await fetch(url, {cache:"no-store"});
    out.textContent = `Status: ${res.status} ${res.statusText}\nURL: ${url}\n`;
    const text = await res.text();
    out.textContent += `\nErste 300 Zeichen:\n` + text.slice(0,300);
    try {
      const json = JSON.parse(text);
      out.textContent += `\n\n→ JSON ist gültig und enthält ${Array.isArray(json.flow)?(json.flow.length+' Steps'):'kein flow[]-Array'}.`;
    } catch(e) {
      out.textContent += `\n\n⚠️ JSON.parse-Fehler: ` + e.message;
    }
  } catch (e) {
    out.textContent = 'Fetch-Fehler: ' + (e && e.message ? e.message : e);
  }
})();
</script>
