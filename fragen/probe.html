<!doctype html>
<meta charset="utf-8">
<title>Probe</title>
<div id="report" style="font-family:system-ui;padding:16px"></div>

<div id="step"></div>
<button id="prev">Zurück</button>
<button id="next">Weiter</button>
<div id="progress"></div>

<script>
// prüft, ob die 4 IDs existieren:
(function(){
  const ids = ["step","prev","next","progress"];
  const res = ids.map(id => [id, !!document.getElementById(id)]);
  const ok = res.every(([,v]) => v);
  const pre = document.getElementById('report');
  pre.innerHTML = "<h1>Element-Check</h1>" + res.map(([id,v]) => `${id}: ${v?'✅':'❌'}`).join("<br>") +
    "<hr><p>Als nächstes wird /flows/flow.de.json geladen…</p>";
})();

// lädt dein JSON und zeigt die erste Frage an:
(async function(){
  const out = document.getElementById('report');
  try{
    const res = await fetch("/flows/flow.de.json?_="+Date.now(), {cache:"no-store"});
    const txt = await res.text();
    let data;
    try{ data = JSON.parse(txt);}catch(e){ out.innerHTML += "<p>❌ JSON.parse-Fehler: "+e.message+"</p>"; return;}
    const flow = Array.isArray(data) ? data : data.flow;
    if (!Array.isArray(flow) || !flow.length){ out.innerHTML += "<p>❌ Kein flow[] gefunden.</p>"; return; }
    out.innerHTML += "<p>✅ flow[] geladen, Steps: "+flow.length+"</p>";
    const first = flow[0];
    document.getElementById("step").innerHTML =
      `<h2>${first.headline || first.question || 'Step 1'}</h2><p>${first.text||''}</p>`;
    document.getElementById("progress").textContent = "1 / " + flow.length;
  }catch(e){
    out.innerHTML += "<p>❌ Fetch-Fehler: "+(e.message||e)+"</p>";
  }
})();
</script>
